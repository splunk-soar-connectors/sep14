{% extends 'widgets/widget_template.html' %}
{% load custom_template %}

{% block title_color %}{{ title_color|default:'white' }}{% endblock %}
{% block title_text_color %}{{ title_text_color|default:'rgb(101, 71, 150)' }}{% endblock %}
{% block body_color %}{{ body_color|default:'white' }}{% endblock %}
{% block body_text_color %}{{ body_text_color|default:'black' }}{% endblock %}
{% block custom_title_prop %}{% if title_logo %}style="background-size: auto 60%; background-position: 50%; background-repeat: no-repeat; background-image: url('/app_resource/{{ title_logo }}');"{% endif %}{% endblock %}
{% block title1 %}{{ title1 }}{% endblock %}
{% block title2 %}{{ title2 }}{% endblock %}
{% block custom_tools %}
{% endblock %}

{% block widget_content %} <!-- Main Start Block -->

<!-- 
File: sep14_list_endpoints.html

Copyright (c) Phantom Cyber Corporation, 2017

This unpublished material is proprietary to Phantom Cyber.
All rights reserved. The methods and
techniques described herein are considered trade secrets
and/or confidential. Reproduction or distribution, in whole
or in part, is forbidden except by express written permission
of Phantom Cyber Corporation.
-->

<style>

    .sep a:link {
        color: black;
    }

    .sep a:hover {
        text-decoration:underline;
    }

    .sep a:visited {
        color: black;
    }

    .sep .wf-table-vertical {
    width: initial;
    font-size: 12px;
    }

    .sep .wf-table-vertical td{
    padding: 8px 10px;
    border: 1px solid rgb(234, 234, 234);
    }

    .sep .wf-table-vertical tr td:first-child {
    font-weight: bold;
    }

    .sep .wf-table-horizontal {
        border: 1px solid rgb(234, 234, 234);
        font-size: 12px;
    }

    .sep .wf-table-horizontal th {
        text-align: center;
        border: 1px solid rgb(234, 234, 234);
        text-transform: uppercase;
        font-weight: normal;
        color: rgb(108, 129, 139);
        padding: 5px;
    }

    .sep .wf-table-horizontal td {
        border: 1px solid rgb(234, 234, 234);
        padding: 5px;
        padding-left: 4px;
    }

    .sep .wf-h3-style {
        font-size : 20px
    }

    .sep .wf-h4-style {
        font-size : 16px
    }

    .sep .collapse.in {
        display: block !important;
    }

    .sep .panel-collapse {
        overflow-x: auto;
    }

    .sep .glyphicon.glyphicon-dot:before {
    content: "\25cf"; font-size: 10px;
    }

</style>
<div class="sep" style="overflow: auto; width: 100%; height: 100%; padding-left:10px; padding-right:10px"> <!-- Main Div -->
    {% for result in results %} <!-- loop for each result -->
    <br>

    <!------------------- For each Result ---------------------->
    {% if not result.data %}
    <h4 class="wf-h4-style">No endpoints found</h4>

    {% else %}
    <h3 class="wf-h3-style">Info</h3>
    {% if result.action_name == "get system info" %}
        <table class="wf-table-vertical">

            <tr>
                <td>IP/Hostname</td>
                <td><a href="javascript:;"
                   onclick="context_menu(this, [{'contains': ['ip', 'host name'], 'value': '{{ result.param.ip_hostname }}' }], 0, {{ container.id }}, null, false);">
                    {{ result.param.ip_hostname }}
                    &nbsp;
                    <span class="fa fa-caret-down" style="font-size: smaller;"></span>
                    </a>
                </td>
            </tr>
        </table>
    {% else %}
        <table class="wf-table-vertical">
            <tr>
                <td>Domain</td>
                <td><a href="javascript:;"
                   onclick="context_menu(this, [{'contains': ['domain'], 'value': '{{ result.param.domain }}' }], 0, {{ container.id }}, null, false);">
                    {{ result.param.domain }}
                    &nbsp;
                    <span class="fa fa-caret-down" style="font-size: smaller;"></span>
                    </a>
                </td>
            </tr>

        </table>
    {% endif %}
    <h3 class="wf-h3-style">Endpoint(s) Info</h3>
    <div class="metadata_div">
        <!--Default View-->
        <div class="panel-group" id="server-information">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h4 class="panel-title">
                        <a data-toggle="collapse" data-parent="default-view" href="#default-view-table">Default View:</a>
                    </h4>
                </div>

                <div id="default-view-table" class="panel-collapse collapse in">
                    <table class="wf-table-horizontal datatable">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Health State</th>
                                <th>Logon User or Computer</th>
                                <th>Last Time Status Changed</th>
                                <th>Last Scan Started</th>
                                <th>Policy Serial Number</th>
                                <th>Firewall Status</th>
                                <th>Restart Required</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for current_entry in result.data %}
                            <tr>
                                <td>
                                    <a href="javascript:;"
                                       onclick="context_menu(this, [{'contains': ['host name'], 'value': '{{ current_entry.computerName }}' }], 0, {{ container.id }}, null, false);">
                                        {{ current_entry.computerName }}
                                        &nbsp;
                                        <span class="fa fa-caret-down" style="font-size: smaller;"></span>
                                    </a>
                                </td>
                                <td>{{ current_entry.onlineStatus }}</td>
                                <td><a href="javascript:;"
                                       onclick="context_menu(this, [{'contains': ['user name'], 'value': '{{ current_entry.logonUserName }}' }], 0, {{ container.id }}, null, false);">
                                        {{ current_entry.logonUserName }}
                                        &nbsp;
                                        <span class="fa fa-caret-down" style="font-size: smaller;"></span>
                                    </a>
                                </td>
                                <td>{{ current_entry.lastUpdateTime }}</td>
                                <td>{{ current_entry.lastScanTime }}</td>
                                <td>{{ current_entry.profileSerialNo }}</td>
                                <td>{{ current_entry.firewallOnOff }}</td>
                                <td>{{ current_entry.rebootRequired }}</td>
                                <td>{{ current_entry.description|default:'<div class="center">-</div>' }}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <div class="panel-group" id="client-status">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h4 class="panel-title">
                        <a data-toggle="collapse" data-parent="server-information" href="#client-status-table">Client Status:</a>
                    </h4>
                </div>

                <div id="client-status-table" class="panel-collapse collapse">
                    <table class="wf-table-horizontal datatable">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Health State</th>
                                <th>Logon User or Computer</th>
                                <th>IP Address</th>
                                <th>Client Version</th>
                                <th>Last Time Status Changed</th>
                                <th>Restart Required</th>
                                <th>Policy Serial Number</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for current_entry in result.data %}
                            <tr>
                                <td><a href="javascript:;"
                                       onclick="context_menu(this, [{'contains': ['host name'], 'value': '{{ current_entry.computerName }}' }], 0, {{ container.id }}, null, false);">
                                        {{ current_entry.computerName }}
                                        &nbsp;
                                        <span class="fa fa-caret-down" style="font-size: smaller;"></span>
                                    </a>
                                </td>
                                <td>{{ current_entry.onlineStatus }}</td>
                                <td><a href="javascript:;"
                                       onclick="context_menu(this, [{'contains': ['user name'], 'value': '{{ current_entry.logonUserName }}' }], 0, {{ container.id }}, null, false);">
                                        {{ current_entry.logonUserName }}
                                        &nbsp;
                                        <span class="fa fa-caret-down" style="font-size: smaller;"></span>
                                    </a>
                                </td>
                                <td><a href="javascript:;"
                                       onclick="context_menu(this, [{'contains': ['ip'], 'value': '{{ current_entry.ipAddresses }}' }], 0, {{ container.id }}, null, false);">
                                        {{ current_entry.ipAddresses }}
                                        &nbsp;
                                        <span class="fa fa-caret-down" style="font-size: smaller;"></span>
                                    </a>
                                </td>
                                <td>{{ current_entry.agentVersion }}</td>
                                <td>{{ current_entry.lastUpdateTime }}</td>
                                <td>{{ current_entry.rebootRequired }}</td>
                                <td>{{ current_entry.profileSerialNo }}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <div class="panel-group" id="protection-technology">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h4 class="panel-title">
                        <a data-toggle="collapse" data-parent="server-information" href="#protection-technology-table">Protection Technology:</a>
                    </h4>
                </div>

                <div id="protection-technology-table" class="panel-collapse collapse">
                    <table class="wf-table-horizontal datatable">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Health State</th>
                                <th>Logon User or Computer</th>
                                <th>IP Address</th>
                                <th>Last Scan Started</th>
                                <th>Firewall Status</th>
                                <th>SONAR Status</th>
                                <th>Download Protection Status</th>
                                <th>Browser Intrusion Prevention IE</th>
                                <th>Browser Intrusion Prevention FF</th>
                                <th>Tamper Protection Status</th>
                                <th>Early Launch Anti-Malware Driver Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for current_entry in result.data %}
                            <tr>
                                <td><a href="javascript:;"
                                       onclick="context_menu(this, [{'contains': ['host name'], 'value': '{{ current_entry.computerName }}' }], 0, {{ container.id }}, null, false);">
                                        {{ current_entry.computerName }}
                                        &nbsp;
                                        <span class="fa fa-caret-down" style="font-size: smaller;"></span>
                                    </a>
                                </td>
                                <td>{{ current_entry.onlineStatus }}</td>
                                <td><a href="javascript:;"
                                       onclick="context_menu(this, [{'contains': ['user name'], 'value': '{{ current_entry.logonUserName }}' }], 0, {{ container.id }}, null, false);">
                                        {{ current_entry.logonUserName }}
                                        &nbsp;
                                        <span class="fa fa-caret-down" style="font-size: smaller;"></span>
                                    </a>
                                </td>
                                <td><a href="javascript:;"
                                       onclick="context_menu(this, [{'contains': ['ip'], 'value': '{{ current_entry.ipAddresses }}' }], 0, {{ container.id }}, null, false);">
                                        {{ current_entry.ipAddresses }}
                                        &nbsp;
                                        <span class="fa fa-caret-down" style="font-size: smaller;"></span>
                                    </a>
                                </td>
                                <td>{{ current_entry.lastScanTime }}</td>
                                <td>{{ current_entry.firewallOnOff }}</td>
                                <td>{{ current_entry.ptpOnOff }}</td>
                                <td>{{ current_entry.apOnOff }}</td>
                                <td>{{ current_entry.cidsBrowserIeOnOff }}</td>
                                <td>{{ current_entry.cidsBrowserFfOnOff }}</td>
                                <td>{{ current_entry.tamperOnOff }}</td>
                                <td>{{ current_entry.elamOnOff }}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <div class="panel-group" id="network-info">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h4 class="panel-title">
                        <a data-toggle="collapse" data-parent="server-information" href="#network-info-table">Network Information:</a>
                    </h4>
                </div>

                <div id="network-info-table" class="panel-collapse collapse">
                    <table class="wf-table-horizontal datatable">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Health State</th>
                                <th>Domain/Workgroup</th>
                                <th>Logon User or Computer</th>
                                <th>IP Address</th>
                                <th>DNS Server</th>
                                <th>WINS Server</th>
                                <th>MAC Address</th>
                                <th>Gateway</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for current_entry in result.data %}
                            <tr>
                                <td><a href="javascript:;"
                                       onclick="context_menu(this, [{'contains': ['host name'], 'value': '{{ current_entry.computerName }}' }], 0, {{ container.id }}, null, false);">
                                        {{ current_entry.computerName }}
                                        &nbsp;
                                        <span class="fa fa-caret-down" style="font-size: smaller;"></span>
                                    </a>
                                </td>
                                <td>{{ current_entry.onlineStatus }}</td>
                                <td><a href="javascript:;"
                                       onclick="context_menu(this, [{'contains': ['domain'], 'value': '{{ current_entry.domainOrWorkgroup }}' }], 0, {{ container.id }}, null, false);">
                                        {{ current_entry.domainOrWorkgroup }}
                                        &nbsp;
                                        <span class="fa fa-caret-down" style="font-size: smaller;"></span>
                                    </a>
                                </td>
                                <td><a href="javascript:;"
                                       onclick="context_menu(this, [{'contains': ['user name'], 'value': '{{ current_entry.logonUserName }}' }], 0, {{ container.id }}, null, false);">
                                        {{ current_entry.logonUserName }}
                                        &nbsp;
                                        <span class="fa fa-caret-down" style="font-size: smaller;"></span>
                                    </a>
                                </td>
                                <td><a href="javascript:;"
                                       onclick="context_menu(this, [{'contains': ['ip'], 'value': '{{ current_entry.ipAddresses }}' }], 0, {{ container.id }}, null, false);">
                                        {{ current_entry.ipAddresses }}
                                        &nbsp;
                                        <span class="fa fa-caret-down" style="font-size: smaller;"></span>
                                    </a>
                                </td>
                                <td>
                                    {% for dns_server in current_entry.dnsServers %}
                                    <span class="glyphicon glyphicon-dot"></span>&nbsp;
                                    <a href="javascript:;"
                                       onclick="context_menu(this, [{'contains': ['ip'], 'value': '{{ dns_server }}' }], 0, {{ container.id }}, null, false);">
                                        {{ dns_server }}
                                        &nbsp;
                                        <span class="fa fa-caret-down" style="font-size: smaller;"></span>
                                    </a>
                                    {% if not forloop.last %}<br/> {% endif %}
                                    {% endfor %}
                                </td>
                                <td>
                                    {% for win_server in current_entry.winServers %}
                                    <span class="glyphicon glyphicon-dot"></span>&nbsp;
                                    <a href="javascript:;"
                                       onclick="context_menu(this, [{'contains': ['ip'], 'value': '{{ win_server }}' }], 0, {{ container.id }}, null, false);">
                                        {{ win_server }}
                                        &nbsp;
                                        <span class="fa fa-caret-down" style="font-size: smaller;"></span>
                                    </a>
                                    {% if not forloop.last %}<br/> {% endif %}
                                    {% endfor %}
                                </td>
                                <td><a href="javascript:;"
                                       onclick="context_menu(this, [{'contains': ['mac address'], 'value': '{{ current_entry.macAddresses }}' }], 0, {{ container.id }}, null, false);">
                                        {{ current_entry.macAddresses }}
                                        &nbsp;
                                        <span class="fa fa-caret-down" style="font-size: smaller;"></span>
                                    </a>
                                </td>
                                <td><a href="javascript:;"
                                       onclick="context_menu(this, [{'contains': ['ip'], 'value': '{{ current_entry.gateways }}' }], 0, {{ container.id }}, null, false);">
                                        {{ current_entry.gateways }}
                                        &nbsp;
                                        <span class="fa fa-caret-down" style="font-size: smaller;"></span>
                                    </a></td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <div class="panel-group" id="client-system-info">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h4 class="panel-title">
                        <a data-toggle="collapse" data-parent="server-information" href="#client-system-info-table">Client System:</a>
                    </h4>
                </div>

                <div id="client-system-info-table" class="panel-collapse collapse">
                    <table class="wf-table-horizontal datatable">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Health State</th>
                                <th>Logon User or Computer</th>
                                <th>IP Address</th>
                                <th>Operating System</th>
                                <th>Service Pack</th>
                                <th>Free Memory</th>
                                <th>Free Disk Space</th>
                                <th>Total Disk Space</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for current_entry in result.data %}
                            <tr>
                                <td><a href="javascript:;"
                                       onclick="context_menu(this, [{'contains': ['host name'], 'value': '{{ current_entry.computerName }}' }], 0, {{ container.id }}, null, false);">
                                        {{ current_entry.computerName }}
                                        &nbsp;
                                        <span class="fa fa-caret-down" style="font-size: smaller;"></span>
                                    </a>
                                </td>
                                <td>{{ current_entry.onlineStatus }}</td>
                                <td><a href="javascript:;"
                                       onclick="context_menu(this, [{'contains': ['user name'], 'value': '{{ current_entry.logonUserName }}' }], 0, {{ container.id }}, null, false);">
                                        {{ current_entry.logonUserName }}
                                        &nbsp;
                                        <span class="fa fa-caret-down" style="font-size: smaller;"></span>
                                    </a>
                                </td>
                                <td><a href="javascript:;"
                                       onclick="context_menu(this, [{'contains': ['ip'], 'value': '{{ current_entry.ipAddresses }}' }], 0, {{ container.id }}, null, false);">
                                        {{ current_entry.ipAddresses }}
                                        &nbsp;
                                        <span class="fa fa-caret-down" style="font-size: smaller;"></span>
                                    </a>
                                </td>
                                <td>{{ current_entry.operatingSystem }}</td>
                                <td>{{ current_entry.osServicePack }}</td>
                                <td>{{ current_entry.freeMem }}</td>
                                <td>{{ current_entry.freeDisk }}</td>
                                <td>{{ current_entry.totalDiskSpace }}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

    </div>
    <br>
    {% endif %}
    {% endfor %} <!-- loop for each result end -->
</div> <!-- Main Div -->


<script>
    $.extend(true, $.fn.dataTable.defaults, {
        "searching": false,
        "bLengthChange": false,
        "language": {
            "paginate": {
                "previous": "<i class='fa fa-angle-left fa-lg'></i>",
                "next": "<i class='fa fa-angle-right fa-lg'></i>"
            }
        },
        "dom": '<"top">rt<"bottom"p><"clear">',
        drawCallback: function(settings) {
            var pagination = $(this).closest('.dataTables_wrapper').find('.dataTables_paginate');
            pagination.toggle(this.api().page.info().pages > 1);
        }
    });
    $.fn.DataTable.ext.pager.numbers_length = 5;
    $('.datatable').DataTable();
</script>
{% endblock %} <!-- Main Start Block -->

